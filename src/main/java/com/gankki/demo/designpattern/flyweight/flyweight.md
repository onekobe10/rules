# 享元模式 Flyweight

Flyweight 拳击比赛特用名词 “特轻量级”。类要轻量级，粒度要小

在对象池中，对象一旦产生，必然有一个唯一的、可访问的状态标志该对象，而且池中的对象声明是由池容器决定的，而不是由使用者决定的。

享元模式是池技术的重要实现方式

@Deprecated, 不要删除代码，使用过期注解注释

Use sharing to support large numbers of fine-grained objects efficiently.

使用共享对象可有效地支持大量的细粒度的对象

对象的信息分为两个状态：内部状态（intrinsic）和外部状态（extrinsic）
1. 内部状态是对象可共享出来的信息，存储在享元对象内部并且不会随环境改变而改变，不必直接存储在具体某个对象中，属于可以共享的部分
2. 外部状态是对象得以依赖的一个标记，是随环境改变而改变的，不可以共享的状态。

细粒度的对象和共享对象，享元模式的目的在于运用共享技术，使得一些细粒度的对象可以共享。多使用细粒度的对象，便于重用或重构。

在程序开发中，确认只需一次复制的属性则设置为final类型，避免无意修改导致逻辑混乱，特别是Session级的常量或者变量

#### 优点和缺点
1. 可以大大减少应用程序创建的对象，降低程序内存的占用，但同时也提高了系统复杂性，需要分离出外部状态和内部状态，而且外部状态具有固化特性，不应该随内部状态改变而改变，否则会导致系统的逻辑混乱


#### 使用场景
1. 系统中存在大量相似的对象
2. 细粒度的对象都具备接近的外部状态，而且内部状态与环境无关，也就是说对象没有特定身份
3. 需要缓冲池的场景


#### 最佳实践
1. String的字符串常量池，对象池重在对象的复用上，池中的每个对象都是可以替换的。从池中获取A对象还是B对象对客户端来说完全相同，主要解决的问题是复用
2. 享元模式主要解决的是对象的共享问题，如何建立多个可共享的细粒度对象则是其关注的重点
















